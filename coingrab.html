<!doctype html>
<html lang="en">
<head>
<meta charset="utf-8" />
<meta name="viewport" content="width=device-width,initial-scale=1" />
<title>Coin Grabber ‚Äî Nitish's Game Zone</title>
<style>
  :root{
    --bg1:#ff9a9e; --bg2:#fad0c4; --bg3:#f6d365; --accent:#ffd54f;
  }
  html,body{height:100%;margin:0;font-family:Poppins,system-ui,-apple-system,Segoe UI,Roboto,"Helvetica Neue",Arial}
  body{
    background: radial-gradient(circle at 10% 20%, #ffd6e0 0%, transparent 20%),
                radial-gradient(circle at 90% 80%, #d7f0ff 0%, transparent 18%),
                linear-gradient(120deg,var(--bg1),var(--bg2) 40%,var(--bg3) 100%);
    overflow:hidden;
    display:flex;
    align-items:center;
    justify-content:center;
  }

  /* container */
  .game-wrap{
    position:relative;
    width:100%;
    height:100vh;
    max-width:1200px;
    max-height:100vh;
    margin:0 auto;
    display:block;
  }

  /* top bar */
  .topbar{
    position:absolute;
    top:12px;
    left:12px;
    right:12px;
    display:flex;
    justify-content:space-between;
    align-items:center;
    z-index:40;
    pointer-events:none;
  }
  .left-controls, .right-controls{display:flex;gap:10px;pointer-events:auto}
  .score{
    background:rgba(255,255,255,0.85);
    color:#222;
    padding:8px 14px;border-radius:999px;
    font-weight:700; box-shadow:0 6px 18px rgba(0,0,0,0.12);
  }
  .btn{
    background:linear-gradient(90deg,#6a5cff,#9b7bff);
    color:white;border:none;padding:8px 12px;border-radius:10px;font-weight:700;cursor:pointer;
    box-shadow:0 6px 20px rgba(107, 90, 255, 0.18);
  }
  .btn.secondary{background:linear-gradient(90deg,#ff7a7a,#ffb27a)}

  /* canvas full-screen inside wrap */
  canvas#gameCanvas{position:absolute;inset:0;width:100%;height:100%;display:block;z-index:1}

  /* basket (HTML/SVG overlay) */
  .basket{
    position:absolute;
    z-index:30;
    width:120px;
    height:90px;
    left:50%;
    transform:translateX(-50%);
    bottom:32px;
    touch-action:none; /* allow dragging */
    display:flex;
    align-items:flex-end;
    justify-content:center;
    pointer-events:auto;
  }
  .basket svg{width:100%;height:100%;pointer-events:none;filter:drop-shadow(0 6px 12px rgba(0,0,0,0.25))}

  /* overlay when game over */
  .overlay{
    position:absolute;
    inset:0;
    z-index:60;
    display:flex;
    align-items:center;
    justify-content:center;
    background:linear-gradient(0deg, rgba(0,0,0,0.45), rgba(0,0,0,0.25));
    opacity:0;pointer-events:none;transition:opacity .25s ease;
    flex-direction:column;gap:16px;
  }
  .overlay.show{opacity:1;pointer-events:auto}
  .panel{
    background:white;color:#222;padding:18px 22px;border-radius:14px;min-width:240px;text-align:center;
    box-shadow:0 10px 30px rgba(0,0,0,0.25)
  }
  .bigscore{font-size:28px;font-weight:800;margin-top:6px}
  .small{font-size:13px;color:#666;margin-top:6px}
  .overlay .panel .btn{width:140px;margin-top:8px}

  /* explosion particle container */
  .explosion {
    position:absolute; left:0; top:0; width:100%; height:100%; pointer-events:none; z-index:50;
  }

  footer{
    position:absolute;left:0;right:0;bottom:6px;text-align:center;color:#062033;opacity:0.95;font-weight:600;z-index:40;
  }

  /* small responsive tweaks */
  @media (max-width:520px){
    .basket{width:100px;height:80px;bottom:18px}
    .btn{padding:8px 10px;font-size:14px}
    .score{padding:6px 10px}
  }
</style>
</head>
<body>
  <div class="game-wrap" id="gameWrap">
    <div class="topbar">
      <div class="left-controls">
        <div class="score" id="scoreboard">Score: 0</div>
      </div>
      <div class="right-controls">
        <button class="btn secondary" id="returnBtn">üè† Return to Dashboard</button>
      </div>
    </div>

    <canvas id="gameCanvas"></canvas>

    <!-- cute basket (SVG) -->
    <div class="basket" id="basket" aria-label="Basket to catch coins">
      <!-- simple cute basket SVG -->
      <svg viewBox="0 0 120 90" xmlns="http://www.w3.org/2000/svg" aria-hidden>
        <defs>
          <linearGradient id="bG" x1="0" x2="1"><stop offset="0" stop-color="#ffcc80"/><stop offset="1" stop-color="#ffab40"/></linearGradient>
          <linearGradient id="bH" x1="0" x2="1"><stop offset="0" stop-color="#8d6e63"/><stop offset="1" stop-color="#6d4c41"/></linearGradient>
        </defs>
        <!-- basket body -->
        <rect x="8" y="28" width="104" height="48" rx="10" fill="url(#bG)" stroke="#6b4226" stroke-width="2"/>
        <!-- rim -->
        <rect x="6" y="20" width="108" height="12" rx="6" fill="#6b4226"/>
        <!-- cute face -->
        <circle cx="38" cy="48" r="5" fill="#5d4037"/>
        <circle cx="82" cy="48" r="5" fill="#5d4037"/>
        <path d="M 48 62 q 12 12 24 0" stroke="#4e342e" stroke-width="3" fill="none" stroke-linecap="round"/>
      </svg>
    </div>

    <!-- explosion particles container -->
    <div class="explosion" id="explosionLayer"></div>

    <!-- overlay / game over -->
    <div class="overlay" id="overlay">
      <div class="panel">
        <div style="font-size:20px;font-weight:800">Boom! üí•</div>
        <div class="small">You caught a bomb</div>
        <div class="bigscore" id="finalScore">Score: 0</div>
        <div style="display:flex;gap:10px;justify-content:center">
          <button class="btn" id="tryAgain">Restart</button>
          <button class="btn secondary" id="goHome">Dashboard</button>
        </div>
      </div>
    </div>

    <footer>Designed by Nitish Agrawal | All Rights Reserved</footer>
  </div>

<script>
/* Coin Grabber
 - Canvas handles falling objects (coins and bombs)
 - Basket is an HTML/SVG overlay dragged by touch/mouse
 - Catch detection uses bounding rectangles
 - Coins: ‚Çπ1, ‚Çπ2, ‚Çπ5, ‚Çπ10
 - Bomb ends game with explosion animation
 - Sound: WebAudio synthesized coin cling
*/

// === Setup canvas ===
const canvas = document.getElementById('gameCanvas');
const ctx = canvas.getContext('2d', { alpha: true });
const wrap = document.getElementById('gameWrap');
const scoreboard = document.getElementById('scoreboard');
const overlay = document.getElementById('overlay');
const finalScore = document.getElementById('finalScore');
const explosionLayer = document.getElementById('explosionLayer');

let W=0, H=0;
function fitCanvas(){
  W = wrap.clientWidth;
  H = wrap.clientHeight;
  canvas.width = Math.floor(W * devicePixelRatio);
  canvas.height = Math.floor(H * devicePixelRatio);
  canvas.style.width = W + 'px';
  canvas.style.height = H + 'px';
  ctx.setTransform(devicePixelRatio,0,0,devicePixelRatio,0,0);
}
window.addEventListener('resize', fitCanvas);
fitCanvas();

// === Game state ===
let objects = []; // falling objects
let particles = []; // explosion visuals (DOM)
let lastSpawn = 0;
let spawnInterval = 600; // ms
let score = 0;
let running = true;

// coin types with weights
const COIN_TYPES = [
  {value:1, color:'#ffd54f', label:'1'},   // common
  {value:2, color:'#ffb74d', label:'2'},   // common
  {value:5, color:'#ff8a65', label:'5'},   // less
  {value:10,color:'#ff5252', label:'10'}   // rare
];
// spawn weights (probabilities)
const WEIGHTS = [50, 30, 15, 5]; // sum 100

// Bomb probability
const BOMB_CHANCE = 0.08; // 8% of spawns

// basket element
const basketEl = document.getElementById('basket');

// initialize basket center
let basket = {
  x: (W/2) - 60,
  y: H - 120,
  width: 120,
  height: 90
};
function positionBasket(){
  basketEl.style.left = Math.max(8, Math.min(W - basket.width - 8, basket.x)) + 'px';
  basketEl.style.bottom = '32px'; // keep visual anchored to bottom
}
positionBasket();

// === WebAudio coin sound ===
const audioCtx = new (window.AudioContext || window.webkitAudioContext)();
function playCoinSound(){
  const o = audioCtx.createOscillator();
  const g = audioCtx.createGain();
  o.type = 'triangle';
  o.frequency.setValueAtTime(900, audioCtx.currentTime);
  o.frequency.exponentialRampToValueAtTime(400, audioCtx.currentTime + 0.25);
  g.gain.setValueAtTime(0.0001, audioCtx.currentTime);
  g.gain.exponentialRampToValueAtTime(0.6, audioCtx.currentTime+0.02);
  g.gain.exponentialRampToValueAtTime(0.001, audioCtx.currentTime+0.35);
  o.connect(g); g.connect(audioCtx.destination);
  o.start(); o.stop(audioCtx.currentTime+0.36);
}

// === helpers ===
function rand(min,max){ return Math.random()*(max-min)+min; }
function chooseWeighted(types, weights){
  const r = Math.random()*weights.reduce((a,b)=>a+b,0);
  let s=0;
  for(let i=0;i<types.length;i++){
    s += weights[i];
    if(r <= s) return types[i];
  }
  return types[0];
}

// === spawn objects ===
function spawnObject(){
  if(!running) return;
  const x = rand(30, W-30);
  const dropSpeed = rand(1.2, 3.2) + Math.min(0.6, score*0.03); // slightly speed up with score

  // decide bomb?
  if(Math.random() < BOMB_CHANCE){
    objects.push({
      type:'bomb', x, y:-40, r:18, speed:dropSpeed*1.1, born:Date.now()
    });
    return;
  }

  // else coin type
  const coinType = chooseWeighted(COIN_TYPES, WEIGHTS);
  objects.push({
    type:'coin', x, y:-40, r: 16 + Math.random()*8, speed: dropSpeed,
    value: coinType.value, color: coinType.color, label: coinType.label, wobble: Math.random()*Math.PI*2
  });
}

// === explosion DOM particle (for bomb) ===
function showExplosion(x,y){
  const p = document.createElement('div');
  p.style.position='absolute';
  p.style.left = (x-10)+'px';
  p.style.top = (y-10)+'px';
  p.style.width = '20px';
  p.style.height = '20px';
  p.style.borderRadius='50%';
  p.style.background = 'radial-gradient(circle,#fff59d,#ff7043)';
  p.style.transform='scale(0)';
  p.style.opacity='0.95';
  p.style.pointerEvents='none';
  explosionLayer.appendChild(p);

  // expand + fade and create several shards
  setTimeout(()=> p.style.transform='scale(6)', 10);
  setTimeout(()=> p.style.opacity='0', 300);
  setTimeout(()=> p.remove(), 700);

  // small shards
  for(let i=0;i<10;i++){
    const s = document.createElement('div');
    s.style.position='absolute';
    s.style.left = x + 'px';
    s.style.top = y + 'px';
    s.style.width = '8px';
    s.style.height = '8px';
    s.style.background = '#ffeb3b';
    s.style.borderRadius='3px';
    s.style.opacity='0.95';
    s.style.transform = 'translate(0,0)';
    s.style.transition = 'transform 700ms cubic-bezier(.2,.8,.2,1), opacity 700ms';
    explosionLayer.appendChild(s);
    const dx = rand(-120,120), dy = rand(-80,120);
    requestAnimationFrame(()=> s.style.transform = `translate(${dx}px, ${dy}px) rotate(${rand(-360,360)}deg)`);
    setTimeout(()=> s.style.opacity='0', 600);
    setTimeout(()=> s.remove(), 900);
  }
}

// === game loop ===
let lastTime = performance.now();
function update(now){
  const dt = now - lastTime;
  lastTime = now;

  // spawn interval
  if(now - lastSpawn > spawnInterval){
    spawnObject();
    lastSpawn = now;
    // tiny randomize spawn interval for variety
    spawnInterval = 450 + Math.random()*500 - Math.min(200, score*6);
  }

  // clear canvas
  ctx.clearRect(0,0,W,H);

  // draw gentle floating decorative circles in background (funky)
  drawBackgroundDecor(now);

  // update & draw objects
  for(let i=objects.length-1;i>=0;i--){
    const o = objects[i];
    o.y += o.speed * (dt/16); // scale to frame time

    // wobble coins
    if(o.type==='coin') o.wobble += 0.06 * (dt/16);

    // draw
    if(o.type==='coin') drawCoin(o);
    else drawBomb(o);

    // check catch by basket bounding box
    const basketRect = basketEl.getBoundingClientRect();
    const canvasRect = canvas.getBoundingClientRect();
    // convert object coords to page coordinates
    const objPageX = canvasRect.left + o.x;
    const objPageY = canvasRect.top + o.y;

    // simple collision: check if object bottom crosses basket top and x overlaps
    if(o.y + o.r >= (H - (basket.height + 32))){ // near basket
      // check horizontal overlap
      const objL = o.x - o.r, objR = o.x + o.r;
      const bL = basket.x, bR = basket.x + basket.width;
      if(objR >= bL && objL <= bR){
        // CATCH!
        if(o.type === 'coin'){
          score += o.value;
          scoreboard.textContent = 'Score: ' + score;
          playCoinSound();
          // pop animation (brief ring)
          popAnim(o.x, o.y, o.color);
          objects.splice(i,1);
          continue;
        } else if(o.type === 'bomb'){
          // bomb caught -> explosion, end game
          showExplosion(o.x, o.y);
          objects.splice(i,1);
          gameOver();
          return; // stop update
        }
      }
    }

    // remove if off screen
    if(o.y - o.r > H + 50) objects.splice(i,1);
  }

  // continue
  if(running) requestAnimationFrame(update);
}
requestAnimationFrame(update);

// === draw helpers ===
function drawCoin(o){
  // subtle shadow
  ctx.beginPath();
  ctx.ellipse(o.x + 4, o.y + 6, o.r*0.9, o.r*0.45, 0, 0, Math.PI*2);
  ctx.fillStyle = 'rgba(0,0,0,0.12)';
  ctx.fill();

  // shining gradient
  const g = ctx.createRadialGradient(o.x - o.r*0.2, o.y - o.r*0.4, 1, o.x, o.y, o.r);
  g.addColorStop(0,'#fff');
  g.addColorStop(0.25, o.color);
  g.addColorStop(1, shadeColor(o.color, -20));
  ctx.beginPath();
  ctx.arc(o.x, o.y, o.r, 0, Math.PI*2);
  ctx.fillStyle = g;
  ctx.fill();

  // rupee symbol and value
  ctx.fillStyle = '#4e342e';
  ctx.font = (o.r*0.9|0) + 'px Poppins, sans-serif';
  ctx.textAlign = 'center';
  ctx.textBaseline = 'middle';
  ctx.fillText('‚Çπ' + o.label, o.x, o.y);
}

function drawBomb(o){
  // body
  ctx.beginPath();
  ctx.arc(o.x, o.y, o.r, 0, Math.PI*2);
  ctx.fillStyle = '#333';
  ctx.fill();
  // fuse
  ctx.beginPath();
  ctx.moveTo(o.x + o.r*0.6, o.y - o.r*0.6);
  ctx.lineTo(o.x + o.r*1.4, o.y - o.r*1.4);
  ctx.strokeStyle = '#ffb74d';
  ctx.lineWidth = 3;
  ctx.stroke();
  // small spark pulsing
  const pulse = Math.abs(Math.sin(Date.now()/160));
  ctx.beginPath();
  ctx.arc(o.x + o.r*1.6, o.y - o.r*1.6, 4 + 4*pulse, 0, Math.PI*2);
  ctx.fillStyle = 'rgba(255,200,60,' + (0.6 + 0.4*pulse) + ')';
  ctx.fill();
}

// pop ring animation on canvas
function popAnim(x,y,color){
  const start = performance.now();
  const duration = 420;
  function frame(t){
    const p = (t - start)/duration;
    if(p>1) return;
    ctx.beginPath();
    ctx.arc(x, y, 8 + p*40, 0, Math.PI*2);
    ctx.strokeStyle = color;
    ctx.lineWidth = 3*(1-p);
    ctx.globalAlpha = 1-p;
    ctx.stroke();
    ctx.globalAlpha = 1;
    requestAnimationFrame(frame);
  }
  requestAnimationFrame(frame);
}

// background decor (animated subtle shapes)
function drawBackgroundDecor(now){
  // soft moving circles
  ctx.save();
  ctx.globalAlpha = 0.08;
  ctx.fillStyle = '#ffffff';
  const t = now/1000;
  for(let i=0;i<6;i++){
    const cx = (i*137.3 + t*20) % W;
    const cy = (i*73.5 + Math.sin(t*i) * 40 + H*0.2);
    const r = 90 + (i*10);
    ctx.beginPath(); ctx.ellipse(cx, cy, r, r*0.6, 0, 0, Math.PI*2); ctx.fill();
  }
  ctx.restore();
}

// color shade utility
function shadeColor(hex, percent) {
  // hex like #aabbcc
  const num = parseInt(hex.slice(1),16);
  const r = (num >> 16) + percent;
  const g = ((num >> 8) & 0x00FF) + percent;
  const b = (num & 0x0000FF) + percent;
  return '#' + ( (1<<24) + (Math.max(0,Math.min(255,r))<<16) + (Math.max(0,Math.min(255,g))<<8) + Math.max(0,Math.min(255,b)) ).toString(16).slice(1);
}

// === input: drag basket (touch & mouse) & keyboard ===
let dragging = false;
let dragStartX = 0, basketStartX = 0;

basketEl.addEventListener('pointerdown', (e)=>{
  dragging = true;
  dragStartX = e.clientX;
  basketStartX = basket.x;
  basketEl.setPointerCapture(e.pointerId);
});
window.addEventListener('pointermove', (e)=>{
  if(!dragging) return;
  const dx = e.clientX - dragStartX;
  basket.x = Math.max(8, Math.min(W - basket.width - 8, basketStartX + dx));
  positionBasket();
});
window.addEventListener('pointerup', (e)=>{
  dragging = false;
});

window.addEventListener('keydown', (e)=>{
  if(e.key === 'ArrowLeft'){ basket.x = Math.max(8, basket.x - 28); positionBasket(); }
  if(e.key === 'ArrowRight'){ basket.x = Math.min(W - basket.width - 8, basket.x + 28); positionBasket(); }
});

// === game over handling ===
function gameOver(){
  running = false;
  overlay.classList.add('show');
  finalScore.textContent = 'Score: ' + score;
}

// restart
function restart(){
  // clear objects
  objects = [];
  score = 0;
  scoreboard.textContent = 'Score: 0';
  overlay.classList.remove('show');
  lastSpawn = performance.now();
  running = true;
  requestAnimationFrame(update);
}

// return to dashboard
document.getElementById('returnBtn').addEventListener('click', ()=> {
  // replace URL with your index page if hosted, otherwise goes to root
  window.location.href = 'index.html';
});
document.getElementById('goHome').addEventListener('click', ()=> window.location.href = 'index.html');
document.getElementById('tryAgain').addEventListener('click', ()=> restart());

// Start spawning loop (use setInterval to decouple from RAF)
setInterval(()=> { if(running) spawnObject(); }, 700);

// ensure initial basket sizing & position after load
function init(){
  fitCanvas();
  basket.width = basketEl.offsetWidth;
  basket.height = basketEl.offsetHeight;
  basket.x = (W - basket.width) / 2;
  positionBasket();
  lastSpawn = performance.now();
  requestAnimationFrame(update);
}
init();

</script>
</body>
</html>